<script>
  var authorizeEvent = new CustomEvent('browseEverything.authorize', {detail: <%= JSON.generate(@auth_token).html_safe %>});
  var authorizePromise = new Promise(function(resolve, reject) {
    window.opener.document.dispatchEvent(authorizeEvent);
    return resolve();
  });
  authorizePromise.then(function() {
    window.close();
  });
</script>
